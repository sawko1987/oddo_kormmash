# MRP XLS Import Module

Модуль для импорта данных производства из XLS файла "Плановое.xls" в Odoo.

## Установка

1. Убедитесь, что модуль находится в директории `addons/mrp_xls_import`
2. Перезапустите Odoo сервер
3. Войдите в Odoo как администратор
4. Перейдите в **Apps** (Приложения)
5. Снимите фильтр "Apps" и выберите "All" или "Custom"
6. Найдите модуль **"MRP XLS Import"**
7. Нажмите **"Install"** (Установить)

## Использование

### Где найти меню импорта:

1. **Manufacturing → Products → Import from XLS** (для всех пользователей)
2. **Manufacturing → Configuration → Import from XLS** (только для менеджеров)

### Процесс импорта:

1. Откройте меню **"Import from XLS"**
2. Нажмите кнопку **"Load File"** или перетащите файл
3. Выберите файл **"Плановое.xls"**
4. Установите галочку **"Update Existing Records"** если хотите обновить существующие записи
5. Нажмите **"Import"**
6. Дождитесь завершения импорта
7. Просмотрите результаты в отчете

## Что импортируется:

- **Номенклатура** (машины) → создаются продукты с BOM
- **Материалы** → создаются строки BOM (компоненты)
- **Операции** → создаются операции в маршрутах производства
- **Рабочие центры** → создаются по названиям цехов

## Структура файла:

Файл должен содержать следующие колонки:
1. №п/п (номер строки)
2. Наименование полного изделия
3. Уровень в иерархии
4. Вид объекта (номенклатура, материал, операция)
5. Наименование объекта
6. Код объекта из 1С
7. (пропускается)
8. Количество на деталь
9. Норма на изделие
10. Ед. измерения
11. Цена
12. Стоимость
13. Валюта
14. Владелец объекта
15. (пропускается)
16. Номер строки владельца
17. Цех
18. (пропускается)

## Требования:

- Odoo с установленными модулями: `mrp`, `product`, `stock`
- Python библиотека `xlrd` (обычно уже установлена в Odoo)

## Устранение проблем:

### Меню не видно:

1. Проверьте, что модуль установлен: **Apps → MRP XLS Import → должно быть "Installed"**
2. Убедитесь, что модуль Manufacturing установлен
3. Перезапустите Odoo сервер
4. Обновите страницу браузера (Ctrl+F5)
5. Проверьте права доступа пользователя

### Ошибки при импорте:

- Проверьте формат файла (должен быть .xls или .xlsx)
- Убедитесь, что файл содержит данные начиная с 4-й строки
- Проверьте кодировку файла (должна быть поддерживаемая)
- Просмотрите логи Odoo для детальной информации об ошибках

## Поддержка:

При возникновении проблем проверьте логи Odoo и сообщения об ошибках в интерфейсе импорта.
